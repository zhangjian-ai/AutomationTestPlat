(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0eb26fe4"],{"026f":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"header"},[n("div",{staticClass:"condition"},[n("el-form",{attrs:{inline:!0,model:e.conditions,size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSourceList()}}},[n("el-row",[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"资源名称:"}},[n("el-input",{attrs:{clearable:""},model:{value:e.conditions.name,callback:function(t){e.$set(e.conditions,"name",t)},expression:"conditions.name"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"版本信息:"}},[n("el-input",{attrs:{clearable:""},model:{value:e.conditions.version,callback:function(t){e.$set(e.conditions,"version",t)},expression:"conditions.version"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"贡献者:"}},[n("el-input",{attrs:{clearable:""},model:{value:e.conditions.author,callback:function(t){e.$set(e.conditions,"author",t)},expression:"conditions.author"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"操作系统:"}},[n("el-select",{attrs:{clearable:""},model:{value:e.conditions.os,callback:function(t){e.$set(e.conditions,"os",t)},expression:"conditions.os"}},[n("el-option",{attrs:{label:"Windows",value:"Windows"}}),n("el-option",{attrs:{label:"MacOS",value:"MacOS"}}),n("el-option",{attrs:{label:"Linux/Unix",value:"Linux/Unix"}}),n("el-option",{attrs:{label:"Android",value:"Android"}}),n("el-option",{attrs:{label:"IOS",value:"IOS"}})],1)],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"上传时间:"}},[n("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.conditions.create_time,callback:function(t){e.$set(e.conditions,"create_time",t)},expression:"conditions.create_time"}})],1)],1)],1)],1),n("el-row",[n("el-col",{staticStyle:{"text-align":"left"},attrs:{span:2}},[n("el-button",{attrs:{type:"success",icon:"el-icon-upload",size:"mini"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("资源上传")])],1),n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:21}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini","native-type":"submit"},on:{click:function(t){return e.getSourceList()}}},[e._v("查询")]),n("el-button",{attrs:{type:"",icon:"el-icon-refresh-left",size:"mini"},on:{click:function(t){e.conditions={}}}},[e._v("重置")])],1)],1)],1)]),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.sourceList,"max-height":"54.3em",size:"mini","header-cell-style":{background:"#eef1f6",color:"#606266","text-align":"center"}}},[n("el-table-column",{attrs:{type:"selection",align:"center"}}),n("el-table-column",{attrs:{label:"序号",type:"index","min-width":"50%",align:"center"}}),n("el-table-column",{attrs:{prop:"uid",label:"UID","min-width":"100%",align:"center"}}),n("el-table-column",{attrs:{prop:"name",label:"资源名称","min-width":"300%",align:"center"}}),n("el-table-column",{attrs:{prop:"os",label:"操作系统","min-width":"120%",align:"center"}}),n("el-table-column",{attrs:{prop:"version",label:"版本","min-width":"80%",align:"center"}}),n("el-table-column",{attrs:{prop:"size",label:"大小","min-width":"100%",align:"center"}}),n("el-table-column",{attrs:{prop:"create_time",label:"上传时间","min-width":"150%",align:"center"}}),n("el-table-column",{attrs:{prop:"author",label:"贡献者","min-width":"100%",align:"center"}}),n("el-table-column",{attrs:{label:"操作",align:"center","min-width":"80%"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{disabled:e.showProgress,icon:"el-icon-download",type:"primary",circle:"",size:"mini"},on:{click:function(n){return e.downloadSource(t.row)}}})]}}])})],1),n("el-row",{staticStyle:{"text-align":"right"}},[n("pagination",{attrs:{count:e.count,page:e.page,page_size:e.page_size},on:{"update:page":function(t){e.page=t},"update:page_size":function(t){e.page_size=t},function:e.getSource}})],1),n("el-dialog",{attrs:{title:"资源上传",visible:e.dialogVisible,width:"30%","destroy-on-close":"","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("uploadSource",{on:{changeState:function(t){return e.state=t}}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",size:"mini",disabled:e.state},on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)],1),n("transition",{attrs:{name:"el-zoom-in-bottom"}},[n("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showProgress,expression:"showProgress"}],staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("资源下载")])]),n("div",[n("span",{attrs:{id:"source_name"}},[e._v(e._s(e.name))]),n("el-progress",{attrs:{percentage:e.percentage}})],1)])],1)],1)},s=[],i=(n("b0c0"),n("ac1f"),n("1276"),n("bc3a")),a=n.n(i),r=n("062e"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload"},[n("el-upload",{ref:"upload",staticStyle:{"min-height":"8em","margin-bottom":"1em"},attrs:{limit:1,action:"",accept:".zip, .rar, .tar, .gz, .exe, .dmg, .apk, .ipa","on-change":e.handleChange,"http-request":e.handleHttpRequest,"auto-upload":!1}},[n("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary",disabled:e.state},slot:"trigger"},[e._v("选取文件")]),n("el-button",{staticStyle:{margin:"0 2em"},attrs:{size:"mini",type:"success",disabled:e.state},on:{click:function(t){return e.$refs.upload.submit()}}},[e._v("点击上传")]),n("span",{staticClass:"tips",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.message))])],1),n("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSourceInfo,expression:"showSourceInfo"}],ref:"sourceForm",attrs:{model:e.sourceForm,size:"mini",rules:e.rules}},[n("el-form-item",{attrs:{label:"资源名称:",prop:"name","label-width":"25%"}},[n("el-input",{attrs:{disabled:""},model:{value:e.sourceForm.name,callback:function(t){e.$set(e.sourceForm,"name",t)},expression:"sourceForm.name"}})],1),n("el-form-item",{attrs:{label:"资源大小:",prop:"size","label-width":"25%"}},[n("el-input",{attrs:{disabled:""},model:{value:e.sourceForm.size,callback:function(t){e.$set(e.sourceForm,"size",t)},expression:"sourceForm.size"}})],1),n("el-form-item",{attrs:{label:"操作系统:",prop:"os","label-width":"25%"}},[n("el-select",{attrs:{placeholder:"请选操作系统"},model:{value:e.sourceForm.os,callback:function(t){e.$set(e.sourceForm,"os",t)},expression:"sourceForm.os"}},[n("el-option",{attrs:{label:"Windows",value:"Windows"}}),n("el-option",{attrs:{label:"MacOS",value:"MacOS"}}),n("el-option",{attrs:{label:"Linux/Unix",value:"Linux/Unix"}}),n("el-option",{attrs:{label:"Android",value:"Android"}}),n("el-option",{attrs:{label:"IOS",value:"IOS"}})],1)],1),n("el-form-item",{attrs:{label:"版本号:",prop:"version","label-width":"25%"}},[n("el-input",{attrs:{placeholder:"例如: jdk1.8"},model:{value:e.sourceForm.version,callback:function(t){e.$set(e.sourceForm,"version",t)},expression:"sourceForm.version"}})],1)],1),n("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.showProgress,expression:"showProgress"}],attrs:{percentage:e.percentage}})],1)},c=[],u=(n("fb6a"),n("365c")),d={props:[],data:function(){return{message:"",showSourceInfo:!1,sourceForm:{},rules:{os:[{required:!0}],version:[{required:!0}]},showProgress:!1,finish:0,total:1,state:!1}},methods:{handleHttpRequest:function(e){var t=this;this.$refs.sourceForm.validate((function(n){n&&(t.socket=new WebSocket("ws://".concat(a.a.defaults.baseURL.split("/")[2],"/ws/upload/")),t.showSourceInfo=!1,t.socket.onopen=function(n){t.showProgress=!0,t.message="文件上传中...",t.state=!0,t.$emit("changeState",!0),t.finish=0,t.total=e.file.size,t.socket.send(JSON.stringify(t.sourceForm))},t.socket.onmessage=function(n){var o=n.data.split(".");if("continue"==o[0]&&t.finish<t.total){var s=e.file.slice(t.finish,t.finish+102400);t.socket.send(s),t.finish+=s.size}"saving"==o[0]&&(t.message=o[1]),"close"==o[0]&&(e.onSuccess(),t.message=o[1])},t.socket.onclose=function(e){"close"==e.type&&(t.socket.close(),t.state=!1,t.$emit("changeState",!1))})}))},handleChange:function(e,t){"ready"==e.status&&(this.message="提示: 选取文件后请继续完善资源相关信息",this.sourceForm={},this.showProgress=!1,this.showSourceInfo=!0,this.sourceForm.uid=e.uid,this.sourceForm.name=e.name,this.sourceForm.size=Math.round(e.size/1e4)/100+"M",this.sourceForm.size_bytes=e.size,this.sourceForm.author=this.$store.state.nickname)},download_xmind_template:function(){Object(u["l"])(this.$store.state.xmind_template_id).then((function(e){var t=e.data,n=new FileReader;n.readAsDataURL(t),n.onload=function(t){var n=document.createElement("a"),o=e.headers["content-dispositon"].split("=");n.download=o[o.length-1],n.setAttribute("href",t.target.result),document.body.appendChild(n),n.click(),document.body.removeChild(n)}}))}},computed:{percentage:function(){return Math.floor(this.finish/this.total*100)}}},p=d,h=(n("6848"),n("2877")),m=Object(h["a"])(p,l,c,!1,null,"eaa6f17c",null),f=m.exports,g={data:function(){return{sourceList:[],conditions:{},loading:!1,count:0,page:1,page_size:15,state:!1,dialogVisible:!1,content:[],name:"",cur:0,total:1,flag:0,percentage:0,showProgress:!1}},methods:{getSource:function(){var e=this;this.loading=!0,Object(u["D"])(this.page,this.page_size,this.conditions).then((function(t){e.sourceList=t.data.results,e.count=t.data.count,e.loading=!1}))},getSourceList:function(){this.page=1,this.getSource()},downloadSource:function(e){var t=this;this.name="",this.content=[],this.percentage=this.cur=this.flag=0,this.socket=new WebSocket("ws://".concat(a.a.defaults.baseURL.split("/")[2],"/ws/download/")),this.socket.onopen=function(n){t.socket.send(e.uid),t.showProgress=!0},this.socket.onmessage=function(n){if(0==t.flag){var o=n.data.split(".");return"error"==o[0]&&(t.$message({type:"error",message:o[1]}),t.socket.close(),t.showProgress=!1),"prepare"==o[0]&&(t.name="资源准备中... ".concat(o[1])),"ready"==o[0]&&(o[1]==e.size_bytes+""?(t.total=e.size_bytes,t.flag=1,t.name=e.name,t.socket.send("receiving")):(t.$message({type:"error",message:"抱歉，资源已损坏！"}),t.socket.close(),t.showProgress=!1)),void("close"==o[0]&&(t.socket.close(),t.showProgress=!1))}if(1==t.flag){if(t.content.push(n.data),t.cur+=n.data.size,t.cur%204800!=0&&t.cur!=t.total||(t.percentage=Math.floor(t.cur/t.total*100)),t.cur==t.total){var s=new FileReader;return s.readAsDataURL(new Blob(t.content,{type:"application/octet-stream"})),void(s.onload=function(e){var n=document.createElement("a");n.download=t.name,n.setAttribute("href",e.target.result),document.body.appendChild(n),n.click(),document.body.removeChild(n),t.socket.send("complete")})}t.socket.send("receiving")}},this.socket.onclose=function(e){"close"==e.type&&(t.socket.close(),t.showProgress=!1)}}},created:function(){this.getSource()},components:{pagination:r["a"],uploadSource:f},watch:{showProgress:function(e,t){console.log(e,t)}}},b=g,v=(n("4cb8"),Object(h["a"])(b,o,s,!1,null,"0abf94c1",null));t["default"]=v.exports},"062e":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-pagination",{attrs:{small:"","current-page":e.page,"page-sizes":[15,30,60,100],"page-size":e.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})},s=[],i={props:["count","page","page_size"],data:function(){return{}},methods:{handleSizeChange:function(e){this.$emit("update:page",1),this.$emit("update:page_size",e),this.$emit("function")},handleCurrentChange:function(e){this.$emit("update:page",e),this.$emit("function")}}},a=i,r=n("2877"),l=Object(r["a"])(a,o,s,!1,null,"75ced178",null);t["a"]=l.exports},1276:function(e,t,n){"use strict";var o=n("d784"),s=n("44e7"),i=n("825a"),a=n("1d80"),r=n("4840"),l=n("8aa5"),c=n("50c4"),u=n("14c3"),d=n("9263"),p=n("9f7f"),h=n("d039"),m=p.UNSUPPORTED_Y,f=[].push,g=Math.min,b=4294967295,v=!h((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));o("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=String(a(this)),i=void 0===n?b:n>>>0;if(0===i)return[];if(void 0===e)return[o];if(!s(e))return t.call(o,e,i);var r,l,c,u=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,m=new RegExp(e.source,p+"g");while(r=d.call(m,o)){if(l=m.lastIndex,l>h&&(u.push(o.slice(h,r.index)),r.length>1&&r.index<o.length&&f.apply(u,r.slice(1)),c=r[0].length,h=l,u.length>=i))break;m.lastIndex===r.index&&m.lastIndex++}return h===o.length?!c&&m.test("")||u.push(""):u.push(o.slice(h)),u.length>i?u.slice(0,i):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var s=a(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,s,n):o.call(String(s),t,n)},function(e,s){var a=n(o,this,e,s,o!==t);if(a.done)return a.value;var d=i(this),p=String(e),h=r(d,RegExp),f=d.unicode,v=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(m?"g":"y"),w=new h(m?"^(?:"+d.source+")":d,v),y=void 0===s?b:s>>>0;if(0===y)return[];if(0===p.length)return null===u(w,p)?[p]:[];var x=0,k=0,S=[];while(k<p.length){w.lastIndex=m?0:k;var z,_=u(w,m?p.slice(k):p);if(null===_||(z=g(c(w.lastIndex+(m?k:0)),p.length))===x)k=l(p,k,f);else{if(S.push(p.slice(x,k)),S.length===y)return S;for(var F=1;F<=_.length-1;F++)if(S.push(_[F]),S.length===y)return S;k=x=z}}return S.push(p.slice(x)),S}]}),!v,m)},"1c0b":function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},"1dde":function(e,t,n){var o=n("d039"),s=n("b622"),i=n("2d00"),a=s("species");e.exports=function(e){return i>=51||!o((function(){var t=[],n=t.constructor={};return n[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"44e7":function(e,t,n){var o=n("861d"),s=n("c6b6"),i=n("b622"),a=i("match");e.exports=function(e){var t;return o(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==s(e))}},4840:function(e,t,n){var o=n("825a"),s=n("1c0b"),i=n("b622"),a=i("species");e.exports=function(e,t){var n,i=o(e).constructor;return void 0===i||void 0==(n=o(i)[a])?t:s(n)}},"4cb8":function(e,t,n){"use strict";n("78c1")},6848:function(e,t,n){"use strict";n("7f29")},"78c1":function(e,t,n){},"7f29":function(e,t,n){},8418:function(e,t,n){"use strict";var o=n("c04e"),s=n("9bf2"),i=n("5c6c");e.exports=function(e,t,n){var a=o(t);a in e?s.f(e,a,i(0,n)):e[a]=n}},b0c0:function(e,t,n){var o=n("83ab"),s=n("9bf2").f,i=Function.prototype,a=i.toString,r=/^\s*function ([^ (]*)/,l="name";o&&!(l in i)&&s(i,l,{configurable:!0,get:function(){try{return a.call(this).match(r)[1]}catch(e){return""}}})},e8b5:function(e,t,n){var o=n("c6b6");e.exports=Array.isArray||function(e){return"Array"==o(e)}},fb6a:function(e,t,n){"use strict";var o=n("23e7"),s=n("861d"),i=n("e8b5"),a=n("23cb"),r=n("50c4"),l=n("fc6a"),c=n("8418"),u=n("b622"),d=n("1dde"),p=d("slice"),h=u("species"),m=[].slice,f=Math.max;o({target:"Array",proto:!0,forced:!p},{slice:function(e,t){var n,o,u,d=l(this),p=r(d.length),g=a(e,p),b=a(void 0===t?p:t,p);if(i(d)&&(n=d.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?s(n)&&(n=n[h],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return m.call(d,g,b);for(o=new(void 0===n?Array:n)(f(b-g,0)),u=0;g<b;g++,u++)g in d&&c(o,u,d[g]);return o.length=u,o}})}}]);
//# sourceMappingURL=chunk-0eb26fe4.6eb35b7f.js.map